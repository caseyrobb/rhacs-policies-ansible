- name: 'Log4Shell: CVE-2021-44228 - log4j Remote Code Execution vulnerability'
  SORTEnforcement: true
  SORTLifecycleStage: DEPLOY
  SORTName: 'Log4Shell: CVE-2021-44228 - log4j Remote Code Execution vulnerability'
  categories: [Vulnerability Management]
  criteriaLocked: false
  description: Alert on deployments with images containing the Log4Shell vulnerability
    (CVE-2021-44228). This is a flaw in the Java logging library Apache Log4j in versions
    from 2.0.0 and before as well as version 2.14.1.
  disabled: false
  enforcementActions: [SCALE_TO_ZERO_ENFORCEMENT, UNSATISFIABLE_NODE_CONSTRAINT_ENFORCEMENT]
  eventSource: NOT_APPLICABLE
  exclusions: []
  fields: null
  isDefault: false
  lifecycleStages: [DEPLOY]
  mitreAttackVectors: []
  mitreVectorsLocked: false
  notifiers: []
  policySections:
  - policyGroups:
    - booleanOperator: OR
      fieldName: CVE
      negate: false
      values:
      - {value: CVE-2021-44228}
    sectionName: ''
  policyVersion: '1.1'
  rationale: This vulnerability allows a remote attacker to execute code on the server
    if the system logs an attacker-controlled string value with the attacker's JNDI
    LDAP server lookup.
  remediation: 'Update the log4j libary to version 2.15.0 (which disables the feature
    by default), 2.16.0 (which removes the functionality) or later. If not possible
    to upgrade, there are two possible mitigations for this flaw in versions from 2.10
    to 2.14.1: Set the system property log4j2.formatMsgNoLookups to true, or remove
    the JndiLookup class from the classpath.'
  scope: []
  severity: CRITICAL_SEVERITY
  whitelists: []