- name: 'PwnKit: CVE-2021-4034 - pwnkit Privilege Escalation'
  SORTEnforcement: true
  SORTLifecycleStage: BUILD,DEPLOY
  SORTName: 'PwnKit: CVE-2021-4034 - pwnkit Privilege Escalation'
  categories: [Vulnerability Management, Privileges]
  criteriaLocked: false
  description: Alert on deployments with images containing the polkit pkexec vulnerability
    (CVE-2021-4034). The polkit package is designed to define and handle policies that
    allow unprivileged processes to communicate with privileged processes on a Linux
    system. Pkexec, part of polkit, is a tool that allows the user to execute commands
    as another user according to the polkit policy definitions using the setuid feature.
    The vulnerability found in pkexec allows an unprivileged local attacker to escalate
    privileges, bypassing any authentication and policies due to incorrect handling
    of the processâ€™s argument vector.
  disabled: false
  enforcementActions: [SCALE_TO_ZERO_ENFORCEMENT, UNSATISFIABLE_NODE_CONSTRAINT_ENFORCEMENT]
  eventSource: NOT_APPLICABLE
  exclusions: []
  fields: null
  isDefault: false
  lifecycleStages: [BUILD, DEPLOY]
  mitreAttackVectors:
  - tactic: TA0004
    techniques: []
  mitreVectorsLocked: false
  notifiers: []
  policySections:
  - policyGroups:
    - booleanOperator: OR
      fieldName: CVE
      negate: false
      values:
      - {value: CVE-2021-4034}
    sectionName: ''
  policyVersion: '1.1'
  rationale: The primary risk for customers is the possibility of an unprivileged user
    gaining administrative privileges on the affected systems. The attacker must have
    login access to the target system to carry out the attack.
  remediation: https://access.redhat.com/errata/RHSA-2022:0267#packages
  scope: []
  severity: CRITICAL_SEVERITY
  whitelists: []